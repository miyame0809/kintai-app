<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãŠæ¯ã•ã‚“ã®çµ¦ä¸è¨ˆç®—ãƒ¬ã‚³ãƒ¼ãƒ€ãƒ¼</title>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #fffaf0; color: #333; }
        .card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .input-group { margin-bottom: 10px; }
        label { display: inline-block; width: 80px; font-weight: bold; }
        input { padding: 8px; border: 1px solid #ddd; border-radius: 5px; width: 120px; }
        .btn-save { padding: 12px; background: #ffa500; border: none; color: white; border-radius: 8px; cursor: pointer; font-weight: bold; width: 100%; font-size: 16px; margin-top: 10px; }
        .btn-save:hover { background: #ff8c00; }
        table { width: 100%; border-collapse: collapse; background: white; border-radius: 10px; overflow: hidden; }
        th, td { border-bottom: 1px solid #eee; padding: 12px; text-align: center; }
        th { background: #fff4e0; }
        .total-box { background: #333; color: white; padding: 15px; border-radius: 10px; margin-top: 20px; }
        .delete-btn { color: #ff4d4d; border: none; background: none; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>

<div class="card">
    <h2>å‹¤æ€ ãƒ¬ã‚³ãƒ¼ãƒ€ãƒ¼ ğŸŒ¸</h2>
    <div class="input-group">
        <label>æ™‚çµ¦(å††):</label>
        <input type="number" id="wage" value="1200" onchange="showData()">
    </div>
    <hr>
    <div class="input-group">
        <label>æ—¥ä»˜:</label>
        <input type="date" id="date">
    </div>
    <div class="input-group">
        <label>é–‹å§‹:</label>
        <input type="time" id="start" value="09:00">
    </div>
    <div class="input-group">
        <label>çµ‚äº†:</label>
        <input type="time" id="end" value="18:00">
    </div>
    <div class="input-group">
        <label>ä¼‘æ†©(h):</label>
        <input type="number" id="break" value="1.0" step="0.5">
    </div>
    <button class="btn-save" onclick="saveData()">ã“ã®å†…å®¹ã§è¨˜éŒ²ã™ã‚‹</button>
</div>

<div id="totalArea" class="total-box">
    </div>

<h3>ä»Šæœˆã®å±¥æ­´</h3>
<table id="recordTable">
    <tr><th>æ—¥ä»˜</th><th>æ™‚é–“</th><th>çµ¦æ–™</th><th></th></tr>
</table>

<button onclick="clearData()" style="margin-top:30px; background:none; border:none; color:gray; text-decoration:underline; cursor:pointer;">å…¨ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆ</button>

<script>
    window.onload = function() {
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('date').value = today;
        
        // ä¿å­˜ã•ã‚Œã¦ã„ãŸæ™‚çµ¦ãŒã‚ã‚Œã°èª­ã¿è¾¼ã‚€
        const savedWage = localStorage.getItem('hourlyWage');
        if(savedWage) document.getElementById('wage').value = savedWage;
        
        showData();
    };

    function saveData() {
        const date = document.getElementById('date').value;
        const start = document.getElementById('start').value;
        const end = document.getElementById('end').value;
        const rest = parseFloat(document.getElementById('break').value);
        const wage = parseInt(document.getElementById('wage').value);

        if(!date || !start || !end) { alert("å…¥åŠ›æ¼ã‚ŒãŒã‚ã‚‹ã‚ˆï¼"); return; }

        const s = start.split(':');
        const e = end.split(':');
        const diff = (parseInt(e[0]) + parseInt(e[1])/60) - (parseInt(s[0]) + parseInt(s[1])/60) - rest;

        if (diff < 0) { alert("æ™‚é–“ãŒãƒã‚¤ãƒŠã‚¹ã ã‚ˆï¼"); return; }

        const records = JSON.parse(localStorage.getItem('workRecords') || '[]');
        records.push({ date, hours: diff.toFixed(1) });
        records.sort((a, b) => new Date(a.date) - new Date(b.date));
        
        localStorage.setItem('workRecords', JSON.stringify(records));
        localStorage.setItem('hourlyWage', wage); // æ™‚çµ¦ã‚’ä¿å­˜

        showData();
        alert("ä¿å­˜ã—ãŸã‚ˆï¼ãŠç–²ã‚Œæ§˜âœ¨");
    }

    function showData() {
        const records = JSON.parse(localStorage.getItem('workRecords') || '[]');
        const wage = parseInt(document.getElementById('wage').value) || 0;
        const table = document.getElementById('recordTable');
        const totalArea = document.getElementById('totalArea');
        
        table.innerHTML = '<tr><th>æ—¥ä»˜</th><th>æ™‚é–“</th><th>çµ¦æ–™</th><th></th></tr>';
        let totalHours = 0;

        records.forEach((r, index) => {
            const row = table.insertRow();
            const daySalary = Math.floor(parseFloat(r.hours) * wage);
            
            row.insertCell(0).innerText = r.date.split('-').slice(1).join('/'); // æœˆ/æ—¥ã§è¡¨ç¤º
            row.insertCell(1).innerText = r.hours + "h";
            row.insertCell(2).innerText = daySalary.toLocaleString() + "å††";
            
            // å‰Šé™¤ãƒœã‚¿ãƒ³
            const delCell = row.insertCell(3);
            delCell.innerHTML = `<button class="delete-btn" onclick="deleteLine(${index})">âœ•</button>`;
            
            totalHours += parseFloat(r.hours);
        });

        const totalSalary = Math.floor(totalHours * wage);
        totalArea.innerHTML = `
            <div style="font-size:1.2em; margin-bottom:5px;">ä»Šæœˆã®åˆè¨ˆåŠ´åƒ: <b>${totalHours.toFixed(1)} æ™‚é–“</b></div>
            <div style="font-size:1.5em; color:#ffeb3b;">è¦‹è¾¼ã¿çµ¦ä¸: <b>${totalSalary.toLocaleString()} å††</b></div>
        `;
    }

    function deleteLine(index) {
        if(!confirm("ã“ã®æ—¥ã®è¨˜éŒ²ã‚’æ¶ˆã™ï¼Ÿ")) return;
        const records = JSON.parse(localStorage.getItem('workRecords') || '[]');
        records.splice(index, 1);
        localStorage.setItem('workRecords', JSON.stringify(records));
        showData();
    }

    function clearData() {
        if(confirm("å…¨éƒ¨æ¶ˆã—ã¡ã‚ƒã†ã‚ˆï¼Ÿã„ã„ï¼Ÿ")) {
            localStorage.removeItem('workRecords');
            showData();
        }
    }
</script>
</body>
</html>